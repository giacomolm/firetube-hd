define(["jquery", "underscore", "backbone", "ractive","views/videoItemView","collections/Videos","text!templates/searchView.html"],
    function ($, _, Backbone, Ractive, videoItemView,Videos,template) {

    var searchView = Backbone.View.extend({

        template: new Ractive({template: template}),
       
        events : {
            "touchend mousedown #search_button" : "searchVideos",
        },
	
	searchVideos: function(){
		this.collection = new Videos(document.getElementById('query_field').value);
		this.collection.on("completed", this.render, this);
	},
	
        initialize: function (type) {		
		this.collection = new Videos();
		this.collection.on("completed", this.render, this);
		this.collection.getPopular();
        },
       
        render: function (eventName) {
           $(this.el).html(template);
           
           for(i=0;i<this.collection.length;i++){		   
                $(this.el).append(new videoItemView({
                    model : this.collection.get(i)                    
                  }).render().el);
            }
	    
            return this;
        },
       
      });

    return searchView;

  });
